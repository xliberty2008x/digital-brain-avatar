# –ú–æ–¥—É–ª—å 3: –ü–æ—Ç–æ–∫–∏ OAuth 2.0 (Flows)

–ö–æ–ª–∏ –º–∏ –≥–æ–≤–æ—Ä–∏–º–æ –ø—Ä–æ OAuth, –º–∏ –≥–æ–≤–æ—Ä–∏–º–æ –ø—Ä–æ —Ç–µ, **—è–∫ —Å–∞–º–µ** –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–π —Å–∞–º–∏–π JWT —Ç–æ–∫–µ–Ω. –Ü –∑–∞–ª–µ–∂–∏—Ç—å —Ü–µ –≤—ñ–¥ —Ç–æ–≥–æ, —Ö—Ç–æ –∑ –∫–∏–º —Å–ø—ñ–ª–∫—É—î—Ç—å—Å—è.

## 1. Client Credentials Flow (–ú–∞—à–∏–Ω–∞ –∑ –ú–∞—à–∏–Ω–æ—é)
–¶–µ –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç. –¢–≤—ñ–π –ê–≥–µ–Ω—Ç –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ Auth Server, –∫–∞–∂–µ —Å–≤—ñ–π `client_id` —Ç–∞ `client_secret` (–ø–∞—Ä–æ–ª—å), —ñ –æ–¥—Ä–∞–∑—É –æ—Ç—Ä–∏–º—É—î —Ç–æ–∫–µ–Ω.
- **–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏**: –ö–æ–ª–∏ –ê–≥–µ–Ω—Ç—É (Digital Brain) —Ç—Ä–µ–±–∞ –¥–æ—Å—Ç—É–ø –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –∞–±–æ —ñ–Ω—à–æ–≥–æ —Ç–≤–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É, –¥–µ –Ω–µ–º–∞—î "–∂–∏–≤–æ–≥–æ" –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- **–ê–Ω–∞–ª–æ–≥—ñ—è**: –°–ª—É–∂–±–æ–≤–∏–π –≤—Ö—ñ–¥ –¥–ª—è —Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—É.

## 2. Authorization Code Flow (–í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Google)

–¶–µ —Å–∞–º–µ —Ç–æ–π –≤–∏–ø–∞–¥–æ–∫, –ø—Ä–æ —è–∫–∏–π —Ç–∏ –∑–∞–ø–∏—Ç–∞–≤. –î–∞–≤–∞–π —Ä–æ–∑–ø–∏—à–µ–º–æ –ø–æ –∫—Ä–æ–∫–∞—Ö, —è–∫ —Ü–µ –ø—Ä–∞—Ü—é—î –≤ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ:

1.  **–õ—ñ–Ω–∫**: –ê–≥–µ–Ω—Ç (–∞–±–æ —Ç–≤—ñ–π —Å–∞–π—Ç) –≥–µ–Ω–µ—Ä—É—î –ª—ñ–Ω–∫—É –Ω–∞ Google. –¢–∏ –∫–ª—ñ–∫–∞—î—à —ñ –ª–æ–≥—ñ–Ω–∏—à—Å—è –≤ Google.
2.  **Redirect (The "Catch")**: Google –Ω–µ —Ä–æ–±–∏—Ç—å —è–∫–∏–π—Å—å —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–∞ —Ç–≤—ñ–π —Å–µ—Ä–≤–µ—Ä. –í—ñ–Ω –ø—Ä–æ—Å—Ç–æ –∫–∞–∂–µ —Ç–≤–æ—î–º—É **–ë—Ä–∞—É–∑–µ—Ä—É**: "–ï–π, –±—Ä–∞—É–∑–µ—Ä, —Ç–µ–ø–µ—Ä —ñ–¥–∏ –∑–∞ —Ü—ñ—î—é –∞–¥—Ä–µ—Å–æ—é: `https://—Ç–≤—ñ–π-—Å–µ—Ä–≤–µ—Ä.com/callback?code=ABC123XYZ`".
    - `Redirect URI`: –¶–µ –∞–¥—Ä–µ—Å–∞ —Ç–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞, —è–∫—É —Ç–∏ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –ø—Ä–æ–ø–∏—Å–∞–≤ —É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö Google.
    - `Query Parameter`: –ö–æ–¥ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –ø—Ä—è–º–æ –≤ –∞–¥—Ä–µ—Å–Ω–æ–º—É —Ä—è–¥–∫—É –±—Ä–∞—É–∑–µ—Ä–∞.
3.  **–û–±–º—ñ–Ω (Backend)**: –¢–≤—ñ–π —Å–µ—Ä–≤–µ—Ä "–±–∞—á–∏—Ç—å" —Ü–µ–π –≤—Ö—ñ–¥–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–∞ `/callback`, –¥—ñ—Å—Ç–∞—î `code` –∑ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ —Ä—è–¥–∫–∞ —ñ –≤–∂–µ **—Å–∞–º** (–Ω–µ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä, –∞ –Ω–∞–ø—Ä—è–º—É "—Å–µ—Ä–≤–µ—Ä-—Å–µ—Ä–≤–µ—Ä") –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î —Ü–µ–π –∫–æ–¥ —É Google.
4.  **Google Token**: Google –ø–æ–≤–µ—Ä—Ç–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é: "–¶–µ `cyril@gmail.com`, –≤—ñ–Ω —É—Å–ø—ñ—à–Ω–æ –∑–∞–ª–æ–≥—ñ–Ω–∏–≤—Å—è".
5.  **–¢–≤—ñ–π –†–µ—î—Å—Ç—Ä**: –¢–≤—ñ–π —Å–µ—Ä–≤–µ—Ä –¥–∏–≤–∏—Ç—å—Å—è –≤ —Å–≤–æ—é –±–∞–∑—É/—Ä–µ—î—Å—Ç—Ä: "–¢–∞–∫, —É –Ω–∞—Å —î `cyril@gmail.com`, –≤—ñ–Ω —É –Ω–∞—Å –ê–¥–º—ñ–Ω".
6.  **–ù–∞—à JWT (–§—ñ–Ω–∞–ª)**: –°–µ—Ä–≤–µ—Ä –≤–∏–∫–ª–∏–∫–∞—î –Ω–∞—à **`jwt_handler.encode({"sub": "cyril", "role": "admin"})`**.

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ê–≥–µ–Ω—Ç –æ—Ç—Ä–∏–º—É—î **–Ω–∞—à** —Ç–æ–∫–µ–Ω, —è–∫–æ–º—É –¥–æ–≤—ñ—Ä—è—é—Ç—å –Ω–∞—à—ñ —Ç—É–ª–∑–∏. Google —Ç—É—Ç –≤–∏—Å—Ç—É–ø–∏–≤ –ø—Ä–æ—Å—Ç–æ —è–∫ "–Ω–∞–¥–¥—ñ–π–Ω–∏–π —Å–≤—ñ–¥–æ–∫", —è–∫–∏–π –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–≤ —Ç–≤–æ—é –æ—Å–æ–±—É.

*–ß–æ–º—É –º–∏ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç–æ–∫–µ–Ω —Å–∞–º–æ–≥–æ Google –¥–ª—è –Ω–∞—à–∏—Ö —Ç—É–ª–∑?*
–ë–æ Google –Ω–µ –∑–Ω–∞—î –ø—Ä–æ —Ç–≤–æ—ó –ø—Ä–∞–≤–∞ –≤ —Ç–≤–æ—ó–π —Å–∏—Å—Ç–µ–º—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —â–æ —Ç–∏ –º–∞—î—à –ø—Ä–∞–≤–æ –≤–∏–¥–∞–ª—è—Ç–∏ –∑–∞–ø–∏—Å–∏ –≤ Neo4j). Google –∫–∞–∂–µ —Ç—ñ–ª—å–∫–∏ "—Ü–µ –≤—ñ–Ω". –ê –º–∏ –≤–∂–µ —Å–∞–º—ñ –≤–∏—Ä—ñ—à—É—î–º–æ, —â–æ –π–æ–º—É –º–æ–∂–Ω–∞.

### 2.1. –Ø–∫ –º–∏ "—Ä–æ–∑–ø–∞–∫–æ–≤—É—î–º–æ" —Ç–æ–∫–µ–Ω Google? (OIDC)

–¶–µ –º–∞–≥—ñ—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤. –í–∞–∂–ª–∏–≤–æ —Ä–æ–∑—É–º—ñ—Ç–∏: **OIDC ‚Äî —Ü–µ –Ω–µ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö, —Ü–µ –ø—Ä–æ—Ç–æ–∫–æ–ª (–Ω–∞–±—ñ—Ä –ø—Ä–∞–≤–∏–ª).**

> [!IMPORTANT]
> –ù–µ —ñ—Å–Ω—É—î "–≤—ñ–¥–∫—Ä–∏—Ç–æ—ó –±–∞–∑–∏ –∑ –¥–∞–Ω–∏–º–∏ —é–∑–µ—Ä—ñ–≤". –î–∞–Ω—ñ —Ç–≤–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é –≤ Google ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω—ñ. "–í—ñ–¥–∫—Ä–∏—Ç–∏–º–∏" —î –ª–∏—à–µ **–ö–ª—é—á—ñ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏**.

1.  **–í—ñ–¥–∫—Ä–∏—Ç—ñ –∫–ª—é—á—ñ (Public Keys)**: –¶–µ —è–∫ —Ü–∏—Ñ—Ä–æ–≤–∞ –ø–µ—á–∞—Ç–∫–∞ Google. Google –≤–∏–∫–ª–∞–¥–∞—î —Ü—ñ –∫–ª—é—á—ñ —É –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–æ—Å—Ç—É–ø (JWKS), —â–æ–± –±—É–¥—å-—è–∫–∏–π —Å–µ—Ä–≤–µ—Ä —É —Å–≤—ñ—Ç—ñ –º—ñ–≥ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏: "–ß–∏ —Å–ø—Ä–∞–≤–¥—ñ —Ü–µ–π —Ç–æ–∫–µ–Ω –ø—ñ–¥–ø–∏—Å–∞–≤ Google?". –¶–µ –Ω–µ –¥–∞—î –¥–æ—Å—Ç—É–ø—É –¥–æ —Å–ø–∏—Å–∫—É —é–∑–µ—Ä—ñ–≤, —Ü–µ –ª–∏—à–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏.
2.  **–ü—Ä–æ—Ç–æ–∫–æ–ª (OIDC)**: –¶–µ –¥–æ–º–æ–≤–ª–µ–Ω—ñ—Å—Ç—å –º—ñ–∂ Google —ñ —Ç–≤–æ—ó–º —Å–µ—Ä–≤–µ—Ä–æ–º –ø—Ä–æ —Ç–µ, –≤ —è–∫–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –¥–∞–Ω—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ–º–æ–≤–ª–µ–Ω—ñ—Å—Ç—å, —â–æ –ø–æ–ª–µ –∑ —ñ–º–µ–π–ª–æ–º –∑–∞–≤–∂–¥–∏ –±—É–¥–µ –Ω–∞–∑–∏–≤–∞—Ç–∏—Å—è `email`.
3.  **–ü—Ä–∏–≤–∞—Ç–Ω—ñ—Å—Ç—å**: –î–∞–Ω—ñ –ø—Ä–æ —Ç–µ–±–µ –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å –Ω–∞ —Ç–≤—ñ–π —Å–µ—Ä–≤–µ—Ä **—Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è —Ç–æ–≥–æ**, —è–∫ —Ç–∏ –Ω–∞—Ç–∏—Å–Ω—É–≤ –∫–Ω–æ–ø–∫—É "–î–æ–∑–≤–æ–ª–∏—Ç–∏". Google —Å—Ç–≤–æ—Ä—é—î —Ç–æ–∫–µ–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–ª—è —Ç–≤–æ–≥–æ –ê–≥–µ–Ω—Ç–∞ —ñ –ø—ñ–¥–ø–∏—Å—É—î –π–æ–≥–æ.

**–ß–æ–º—É –º–∏ –∑–Ω–∞—î–º–æ, —è–∫ —Ü–µ —Ä–æ–±–∏—Ç–∏?**
–ë–æ —Ç–≤—ñ–π —Å–µ—Ä–≤–µ—Ä –∑–Ω–∞—î "–∞–¥—Ä–µ—Å—É", –∑–∞ —è–∫–æ—é –ª–µ–∂–∞—Ç—å –∫–ª—é—á—ñ Google. –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `google-auth`) –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î —Ü—ñ –∫–ª—é—á—ñ, –±–µ—Ä–µ —Ç–æ–∫–µ–Ω –≤—ñ–¥ –ê–≥–µ–Ω—Ç–∞ —ñ –∫–∞–∂–µ: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —Å—Ö–æ–¥–∏—Ç—å—Å—è, —Ü–µ —Ç–æ—á–Ω–æ Google –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–≤ –æ—Å–æ–±—É Cyril".

### 2.2. –ß–æ–º—É –ö–æ–¥, –∞ –Ω–µ –î–∞–Ω—ñ? (–ë–µ–∑–ø–µ–∫–∞ –∫–∞–Ω–∞–ª—ñ–≤)

–¶–µ –≥–æ–ª–æ–≤–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ OAuth. –Ü—Å–Ω—É—î –¥–≤–∞ –∫–∞–Ω–∞–ª–∏ –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö:

1.  **Front Channel (–ë—Ä–∞—É–∑–µ—Ä)**: –í—ñ–Ω –≤–≤–∞–∂–∞—î—Ç—å—Å—è **–Ω–µ–Ω–∞–¥–¥—ñ–π–Ω–∏–º**. –í—Å–µ, —â–æ –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ –∞–¥—Ä–µ—Å–Ω–∏–π —Ä—è–¥–æ–∫ –±—Ä–∞—É–∑–µ—Ä–∞, –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è –≤ —ñ—Å—Ç–æ—Ä—ñ—é, –≤ –ª–æ–≥–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, —ñ –º–æ–∂–µ –±—É—Ç–∏ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–æ —à–∫—ñ–¥–ª–∏–≤–∏–º–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º–∏.
    -   –Ø–∫–±–∏ Google –ø–µ—Ä–µ–¥–∞–≤ —Ç–æ–∫–µ–Ω –∞–±–æ —Ç–≤–æ—ó –¥–∞–Ω—ñ –ø—Ä—è–º–æ –≤ URL, —Ö–∞–∫–µ—Ä –º—ñ–≥ –±–∏ —ó—Ö –ª–µ–≥–∫–æ "–ø—ñ–¥–¥–∏–≤–∏—Ç–∏—Å—è".
2.  **Back Channel (–°–µ—Ä–≤–µ—Ä-–°–µ—Ä–≤–µ—Ä)**: –¶–µ –ø—Ä—è–º–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –º—ñ–∂ —Ç–≤–æ—ó–º —Å–µ—Ä–≤–µ—Ä–æ–º —ñ —Å–µ—Ä–≤–µ—Ä–æ–º Google. –í–æ–Ω–æ **–Ω–∞–¥—ñ–π–Ω–µ** —ñ –Ω—ñ—Ö—Ç–æ –∑–∑–æ–≤–Ω—ñ –π–æ–≥–æ –Ω–µ –±–∞—á–∏—Ç—å.

**–õ–æ–≥—ñ–∫–∞ –ö–æ–¥—É**:
-   Google –ø–µ—Ä–µ–¥–∞—î —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (Front Channel) –ª–∏—à–µ **–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∏–π —Ç–∏–º—á–∞—Å–æ–≤–∏–π –ö–æ–¥**. –°–∞–º –ø–æ —Å–æ–±—ñ –≤—ñ–Ω –Ω—ñ—á–æ–≥–æ –Ω–µ –≤–∞—Ä—Ç–∏–π.
-   **–ì–æ–ª–æ–≤–Ω–∏–π –∑–∞–º–æ–∫**: –ö–æ–ª–∏ —Ç–≤—ñ–π —Å–µ—Ä–≤–µ—Ä –π–¥–µ –¥–æ Google (—á–µ—Ä–µ–∑ Back Channel), –≤—ñ–Ω –º–∞—î –ø—Ä–µ–¥'—è–≤–∏—Ç–∏ –¥–≤–∞ –∫–ª—é—á—ñ:
    1.  **Code** (—Ç–æ–π —Å–∞–º–∏–π, —â–æ –ø–µ—Ä–µ–¥–∞–≤ —é–∑–µ—Ä).
    2.  **client_secret** (—Ç–≤—ñ–π —Ç–∞—î–º–Ω–∏–π –ø–∞—Ä–æ–ª—å, —è–∫–∏–π —Ç–∏ –æ—Ç—Ä–∏–º–∞–≤ –ø—Ä–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —Å–≤–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –≤ Google).
-   **–ß–æ–º—É —Ö–∞–∫–µ—Ä –Ω–µ –º–æ–∂–µ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏?** –•–∞–∫–µ—Ä –º–æ–∂–µ –≤–∫—Ä–∞—Å—Ç–∏ `Code` (–±–æ –≤—ñ–Ω –±—É–≤ —É –±—Ä–∞—É–∑–µ—Ä—ñ), –∞–ª–µ –≤—ñ–Ω **–Ω–µ –∑–Ω–∞—î** —Ç–≤—ñ–π `client_secret`. Google –∫–∞–∂–µ: "–¢–∏ –ø—Ä–∏–Ω—ñ—Å –º–µ–Ω—ñ –∫–æ–¥, –∞–ª–µ —Ç–∏ –Ω–µ –º—ñ–π –¥–æ–≤—ñ—Ä–µ–Ω–∏–π –ê–≥–µ–Ω—Ç, –±–æ —Ç–∏ –Ω–µ –∑–Ω–∞—î—à —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –ø–∞—Ä–æ–ª—å. –í—ñ–¥–º–æ–≤–ª–µ–Ω–æ".

### 2.3. Client ID —Ç–∞ Client Secret: –ü–∞—Å–ø–æ—Ä—Ç–∏ –¥–ª—è —Å–æ—Ñ—Ç—É

–¶–µ –¥—É–∂–µ –≤–∞–∂–ª–∏–≤–∏–π –º–æ–º–µ–Ω—Ç, –¥–µ –ª–∞–º–∞—î—Ç—å—Å—è –º—ñ–∑–æ–∫. –Ü—Å–Ω—É—î –¥–≤–∞ —Ç–∏–ø–∏ "–ø–∞—Ä–æ–ª—ñ–≤":

1.  **–¢–≤—ñ–π –ø–∞—Ä–æ–ª—å (User Password)**: –ô–æ–≥–æ –∑–Ω–∞—î—à —Ç—ñ–ª—å–∫–∏ —Ç–∏ —ñ Google. –¢–∏ –≤–≤–æ–¥–∏—à –π–æ–≥–æ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ Google. –ê–≥–µ–Ω—Ç –π–æ–≥–æ **–Ω—ñ–∫–æ–ª–∏ –Ω–µ –±–∞—á–∏—Ç—å**.
2.  **Client Secret (Application Password)**: –¶–µ –ø–∞—Ä–æ–ª—å —Ç–≤–æ–≥–æ **–ê–≥–µ–Ω—Ç–∞/–°–µ—Ä–≤–µ—Ä–∞**. 
    -   –ö–æ–ª–∏ —Ç–∏ —Å—Ç–≤–æ—Ä—é—î—à –ø—Ä–æ—î–∫—Ç —É Google Cloud Console, Google –¥–∞—î —Ç–æ–±—ñ `client_id` (–ª–æ–≥—ñ–Ω –ø—Ä–æ–≥—Ä–∞–º–∏) —Ç–∞ `client_secret` (–ø–∞—Ä–æ–ª—å –ø—Ä–æ–≥—Ä–∞–º–∏).
    -   –¶–µ–π —Å–µ–∫—Ä–µ—Ç –ø—Ä–æ—à–∏—Ç–∏–π —É —Ç–µ–±–µ –≤ –∫–æ–¥—ñ —Å–µ—Ä–≤–µ—Ä–∞ (–∞–±–æ –≤ `.env`).

### 2.4. –Ø–∫ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è Back Channel? (–¢–µ—Ö–Ω—ñ—á–Ω–µ –º'—è—Å–æ)

–¢–∏ –∑–∞–ø–∏—Ç–∞–≤: *"–î–µ –≤ —Ü—å–æ–º—É –º–µ—Ö–∞–Ω—ñ–∑–º—ñ secret?"*. –î–∏–≤–∏—Å—å –Ω–∞ —Ç–∞–π–º–ª–∞–π–Ω:

1.  **Front Channel (–ë—Ä–∞—É–∑–µ—Ä)**: Google —Ä–µ–¥—ñ—Ä–µ–∫—Ç–∏—Ç—å —Ç–µ–±–µ –Ω–∞ `https://—Ç–≤—ñ–π-—Å–µ—Ä–≤–µ—Ä.com/callback?code=ABC`. 
2.  **Callback —Å–ø—Ä–∞—Ü—é–≤–∞–≤**: –¢–≤—ñ–π —Å–µ—Ä–≤–µ—Ä –æ—Ç—Ä–∏–º–∞–≤ –∑–∞–ø–∏—Ç. –í —Ü–µ–π –º–æ–º–µ–Ω—Ç –±—Ä–∞—É–∑–µ—Ä –ø—Ä–æ—Å—Ç–æ "—á–µ–∫–∞—î" –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–∫—Ä—É—Ç–∏—Ç—å—Å—è –∫–æ–ª–µ—á–∫–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è).
3.  **Back Channel (–ú–∞–≥—ñ—è)**: –ü–æ–∫–∏ –±—Ä–∞—É–∑–µ—Ä —á–µ–∫–∞—î, —Ç–≤—ñ–π —Å–µ—Ä–≤–µ—Ä "–ø—ñ–¥ –∫–∞–ø–æ—Ç–æ–º" —Ä–æ–±–∏—Ç—å –∑–≤–∏—á–∞–π–Ω–∏–π **HTTP POST –∑–∞–ø–∏—Ç** –¥–æ Google (–Ω–∞ –∞–¥—Ä–µ—Å—É `https://oauth2.googleapis.com/token`). 
    -   –¶–µ —ñ —î Back Channel ‚Äî –ø—Ä—è–º–µ –∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–≤–æ–≥–æ Python-–∫–æ–¥—É –∑ —Å–µ—Ä–≤–µ—Ä–æ–º Google.
    -   –í —Ç—ñ–ª–æ —Ü—å–æ–≥–æ POST-–∑–∞–ø–∏—Ç—É —Å–µ—Ä–≤–µ—Ä –∫–ª–∞–¥–µ: `code` + `client_id` + `client_secret`.
4.  **Google –ø–µ—Ä–µ–≤—ñ—Ä—è—î**: "–¢–∞–∫, –∫–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π, —ñ —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –ø–∞—Ä–æ–ª—å –ø—Ä–æ–≥—Ä–∞–º–∏ `AvatarBrain` —Ç–µ–∂ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π. –û—Å—å –≤–∞–º —Ç–æ–∫–µ–Ω–∏".
5.  **–§—ñ–Ω–∞–ª**: –¢–≤—ñ–π —Å–µ—Ä–≤–µ—Ä –æ—Ç—Ä–∏–º—É—î —Ç–æ–∫–µ–Ω–∏, –∑–∞–ø–∏—Å—É—î —ó—Ö —Å–æ–±—ñ, —ñ —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É –±—Ä–∞—É–∑–µ—Ä: "–£—Å–ø—ñ—Ö! –ú–æ–∂–µ—à –∑–∞–∫—Ä–∏–≤–∞—Ç–∏ –≤—ñ–∫–Ω–æ".

### 2.5. –ú–µ—Ö–∞–Ω—ñ–∫–∞: –•—Ç–æ, –∫–æ–ª–∏ —Ç–∞ –∫—É–¥–∏ ¬´—Å—Ç—É–∫–∞—î¬ª?

–î–∞–≤–∞–π —Ä–æ–∑–±–µ—Ä–µ–º–æ —Ü–µ —è–∫ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —Ñ—ñ–∑–∏—á–Ω–∏—Ö –ø–æ–¥—ñ–π. –£ –Ω–∞—Å —î 3 —É—á–∞—Å–Ω–∏–∫–∏: **–¢–∏ (–ë—Ä–∞—É–∑–µ—Ä)**, **–¢–≤—ñ–π –°–µ—Ä–≤–µ—Ä (Python)** —Ç–∞ **Google**.

```mermaid
sequenceDiagram
    participant U as –¢–∏ (–ë—Ä–∞—É–∑–µ—Ä)
    participant S as –¢–≤—ñ–π –°–µ—Ä–≤–µ—Ä (Python)
    participant G as Google
    
    Note over U, G: –ü–æ—á–∞—Ç–æ–∫: –¢–∏ —Ö–æ—á–µ—à –∑–∞–ª–æ–≥—ñ–Ω–∏—Ç–∏—Å—å
    U->>S: 1. –ö–ª—ñ–∫ –Ω–∞ "Login with Google"
    S-->>U: 2. Redirect –Ω–∞ Google Auth URL
    U->>G: 3. –í—ñ–¥–∫—Ä–∏–≤–∞—î —Å—Ç–æ—Ä—ñ–Ω–∫—É –ª–æ–≥—ñ–Ω—É Google
    G->>U: 4. –ü–∏—Ç–∞—î –ø–∞—Ä–æ–ª—å —Ç–∞ –¥–æ–∑–≤—ñ–ª
    U->>G: 5. –í–≤–æ–¥–∏—à –ø–∞—Ä–æ–ª—å
    
    Note over G, U: –ú–∞–≥—ñ—è Front Channel (—á–µ—Ä–µ–∑ URL)
    G-->>U: 6. HTTP 302 Redirect –Ω–∞ /callback?code=XYZ
    U->>S: 7. –ó–∞–ø–∏—Ç GET /callback?code=XYZ
    
    Note over S, G: –ú–∞–≥—ñ—è Back Channel (–°–µ—Ä–≤–µ—Ä-–°–µ—Ä–≤–µ—Ä)
    S->>G: 8. POST /token (code=XYZ + client_secret)
    G->>S: 9. –ü–æ–≤–µ—Ä—Ç–∞—î Access Token —Ç–∞ ID Token
    
    Note over S, U: –§—ñ–Ω–∞–ª
    S->>S: 10. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –¥–∞–Ω—ñ, —Å—Ç–≤–æ—Ä—é—î –°–í–Ü–ô JWT
    S-->>U: 11. –í—ñ–¥–ø–æ–≤—ñ–¥—å "–£—Å–ø—ñ—Ö" + –ù–∞—à JWT
```

#### –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ (–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —Ç–≤–æ—ó –ø–∏—Ç–∞–Ω–Ω—è):

- **–•—Ç–æ —á–µ–∫–∞—î?**: –ù–∞ –∫—Ä–æ—Ü—ñ 7, –∫–æ–ª–∏ —Ç–≤—ñ–π –±—Ä–∞—É–∑–µ—Ä –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∑–∞ –ª—ñ–Ω–∫–æ—é `/callback`, –≤—ñ–Ω –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç —Ç–≤–æ—î–º—É —Å–µ—Ä–≤–µ—Ä—É —ñ ¬´–∑–∞–≤–∏—Å–∞—î¬ª. –¢–≤—ñ–π —Å–µ—Ä–≤–µ—Ä (Python) –æ—Ç—Ä–∏–º—É—î —Ü–µ–π –∑–∞–ø–∏—Ç —ñ, –∑–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ —â–æ–± –æ–¥—Ä–∞–∑—É –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏, –≤—ñ–Ω —Å–∞–º ¬´–π–¥–µ –≤ –≥–æ—Å—Ç—ñ¬ª –¥–æ Google (–∫—Ä–æ–∫ 8). –ë—Ä–∞—É–∑–µ—Ä –≤–µ—Å—å —Ü–µ–π —á–∞—Å —á–µ–∫–∞—î.
- **–ß–∏ —î callback —Ñ—É–Ω–∫—Ü—ñ—î—é?**: –£ Python (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É Flask –∞–±–æ FastAPI) —Ç–∏ —Å–ø—Ä–∞–≤–¥—ñ –ø–∏—à–µ—à —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –ø—Ä–∏–≤'—è–∑–∞–Ω–∞ –¥–æ –∞–¥—Ä–µ—Å–∏ `/callback`. 
    ```python
    @app.get("/callback")
    def handle_google_callback(code: str):
        # 1. –ú–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –∫–æ–¥
        # 2. –†–æ–±–∏–º–æ –∑–∞–ø–∏—Ç –¥–æ Google –∑ –Ω–∞—à–∏–º secret
        # 3. –í–∏–¥–∞—î–º–æ —Å–≤—ñ–π —Ç–æ–∫–µ–Ω
        return {"jwt": "..."}
    ```
- **–î–µ Secret?**: –í—ñ–Ω –∑'—è–≤–ª—è—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –Ω–∞ –∫—Ä–æ—Ü—ñ 8. –¢–≤—ñ–π Python-–∫–æ–¥ –¥—ñ—Å—Ç–∞—î –π–æ–≥–æ –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Å–µ—Ä–≤–µ—Ä–∞ —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –≤ Google —Ä–∞–∑–æ–º —ñ–∑ –∫–æ–¥–æ–º, —è–∫–∏–π –ø—Ä–∏–Ω—ñ—Å –±—Ä–∞—É–∑–µ—Ä.

### 2.6. –•—Ç–æ –º–∞—î ¬´–ø—Ä–∏–Ω–æ—Å–∏—Ç–∏¬ª –∫–ª—é—á—ñ? (–†–æ–∑—Ä–æ–±–Ω–∏–∫ vs –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á)

–û—Å—å —Ç—É—Ç –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–π –º–æ–º–µ–Ω—Ç, —â–æ–± —Ç–∏ –Ω–µ —Ö–≤–∏–ª—é–≤–∞–≤—Å—è –∑–∞ —é–∑–µ—Ä—ñ–≤:

> [!IMPORTANT]
> **–Æ–∑–µ—Ä –Ω—ñ—á–æ–≥–æ –Ω–µ —Å—Ç–≤–æ—Ä—é—î –≤ Google Console.** 
> –¢—ñ–ª—å–∫–∏ **–¢–ò (—è–∫ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫)** –æ–¥–∏–Ω —Ä–∞–∑ —Å—Ç–≤–æ—Ä—é—î—à –ø—Ä–æ—î–∫—Ç —É Google, –æ—Ç—Ä–∏–º—É—î—à –æ–¥–∏–Ω `client_id` —Ç–∞ –æ–¥–∏–Ω `client_secret` —ñ –ø—Ä–æ–ø–∏—Å—É—î—à —ó—Ö —É —Å–≤—ñ–π `.env`. –Æ–∑–µ—Ä —Ü—å–æ–≥–æ –≤–∑–∞–≥–∞–ª—ñ –Ω–µ –±–∞—á–∏—Ç—å.

#### –ê–Ω–∞–ª–æ–≥—ñ—è: –ù—ñ—á–Ω–∏–π –∫–ª—É–±
- **Google** ‚Äî —Ü–µ –ü–∞—Å–ø–æ—Ä—Ç–Ω–∏–π —Å—Ç—ñ–ª.
- **–¢–≤—ñ–π –°–µ—Ä–≤–µ—Ä** ‚Äî —Ü–µ –í–ª–∞—Å–Ω–∏–∫ –Ω—ñ—á–Ω–æ–≥–æ –∫–ª—É–±—É.
- **–Æ–∑–µ—Ä** ‚Äî —Ü–µ –ì—ñ—Å—Ç—å.

–ü–æ—Ä—è–¥–æ–∫ –¥—ñ–π:
1.  **–¢–∏ (–í–ª–∞—Å–Ω–∏–∫ –∫–ª—É–±—É)** –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –π–¥–µ—à —É "–ü–∞—Å–ø–æ—Ä—Ç–Ω–∏–π —Å—Ç—ñ–ª" (Google Cloud Console) —ñ –∫–∞–∂–µ—à: *"–Ø –≤—ñ–¥–∫—Ä–∏–≤–∞—é –∫–ª—É–± 'Digital Brain'. –î–∞–π—Ç–µ –º–µ–Ω—ñ –ª—ñ—Ü–µ–Ω–∑—ñ—é"*. 
2.  Google –∫–∞–∂–µ: *"–û—Å—å —Ç–æ–±—ñ –ª—ñ—Ü–µ–Ω–∑—ñ—è (**client_id**) —Ç–∞ —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–æ–¥ (**client_secret**)"*. –¢–∏ —Ö–æ–≤–∞—î—à —ó—Ö —É —Å–µ–π—Ñ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.
3.  **–ì—ñ—Å—Ç—å (–Æ–∑–µ—Ä)** –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –¥–æ —Ç–≤–æ–≥–æ –∫–ª—É–±—É. –í—ñ–Ω –Ω–µ –º–∞—î –∂–æ–¥–Ω–∏—Ö –ª—ñ—Ü–µ–Ω–∑—ñ–π. –í—ñ–Ω –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—É—î **—Å–≤—ñ–π –ø–∞—Å–ø–æ—Ä—Ç** (–ª–æ–≥—ñ–Ω–∏—Ç—å—Å—è —É —Å–≤—ñ–π Google-–∞–∫–∞—É–Ω—Ç).
4.  Google –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î: *"–¶–µ –≤–∞–ª—ñ–¥–Ω–∏–π –ø–∞—Å–ø–æ—Ä—Ç, –æ—Å—å –≤–∞–º —Ç–∏–º—á–∞—Å–æ–≤–∏–π –∫–≤–∏—Ç–æ–∫ (–∫–æ–¥)"*.
5.  **–¢–∏ (–í–ª–∞—Å–Ω–∏–∫)** –±–µ—Ä–µ—à —Ü–µ–π –∫–≤–∏—Ç–æ–∫, –¥—ñ—Å—Ç–∞—î—à —Å–≤–æ—é **–ª—ñ—Ü–µ–Ω–∑—ñ—é (secret)** –∑—ñ —Å–≤–æ–≥–æ —Å–µ–π—Ñ—É —ñ –ø–∏—Ç–∞—î—à Google: *"–Ø –º–∞—é –ª—ñ—Ü–µ–Ω–∑—ñ—é —ñ –æ—Å—å –∫–≤–∏—Ç–æ–∫ –≥–æ—Å—Ç—è. –î–∞–π –º–µ–Ω—ñ —Ç–µ–ø–µ—Ä –π–æ–≥–æ –¥–∞–Ω—ñ"*.

**–û—Ç–∂–µ:** –£ —Ç–≤–æ—ó–π —Å–∏—Å—Ç–µ–º—ñ –±—É–¥–µ —Ç—ñ–ª—å–∫–∏ **–æ–¥–∏–Ω** `client_secret` –Ω–∞ –≤–µ—Å—å —Ç–≤—ñ–π Digital Brain. –Æ–∑–µ—Ä–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω—ñ—á–æ–≥–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, –≤–æ–Ω–∏ –ø—Ä–æ—Å—Ç–æ —Ç–∏—Å–Ω—É—Ç—å –∫–Ω–æ–ø–∫—É "Sign in with Google".

### 2.7. –°—Ü–µ–Ω–∞—Ä—ñ–π: –ê–≥–µ–Ω—Ç —Ö–æ—á–µ –¥–æ—Å—Ç—É–ø –¥–æ —Ç–≤–æ–≥–æ GitHub

–¢–∏ –∑–∞–ø–∏—Ç–∞–≤: *"–ê —è–∫—â–æ —é–∑–µ—Ä –≤–ª–∞—Å–Ω–∏–∫ GitHub —ñ —Ö–æ—á–µ –¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –ê–≥–µ–Ω—Ç—É?"*. –¶–µ –∫–ª–∞—Å–∏–∫–∞ OAuth!

–î–∞–≤–∞–π —Ä–æ–∑–±–µ—Ä–µ–º–æ, —Ö—Ç–æ —â–æ —Ä–æ–±–∏—Ç—å —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É:

1.  **–¢–∏ (–†–æ–∑—Ä–æ–±–Ω–∏–∫)**: –ô–¥–µ—à —É GitHub —ñ —Ä–µ—î—Å—Ç—Ä—É—î—à —Ç–∞–º —Å–≤—ñ–π –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ "Digital Brain". –û—Ç—Ä–∏–º—É—î—à `client_id` —Ç–∞ `client_secret` **–≤—ñ–¥ GitHub –¥–ª—è —Å–≤–æ—î—ó –ø—Ä–æ–≥—Ä–∞–º–∏**.
2.  **–¢–≤—ñ–π –Æ–∑–µ—Ä**: –ó–∞—Ö–æ–¥–∏—Ç—å –¥–æ —Ç–≤–æ–≥–æ –ê–≥–µ–Ω—Ç–∞ —ñ –∫–∞–∂–µ: *"–•–æ—á—É –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ —Å–≤—ñ–π GitHub"*.
3.  **–¢–≤—ñ–π –°–µ—Ä–≤–µ—Ä**: –†–µ–¥—ñ—Ä–µ–∫—Ç–∏—Ç—å —é–∑–µ—Ä–∞ –Ω–∞ GitHub, –∞–ª–µ –¥–æ–¥–∞—î –ø–∞—Ä–∞–º–µ—Ç—Ä **`scope=repo,user`** (—Ü–µ —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–≤: "—á–∏—Ç–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó", "–±–∞—á–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å").
4.  **–Æ–∑–µ—Ä –Ω–∞ GitHub**: –ë–∞—á–∏—Ç—å –≤—ñ–∫–Ω–æ: *"–ü—Ä–æ–≥—Ä–∞–º–∞ Digital Brain –ø—Ä–æ—Å–∏—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤. –î–æ–∑–≤–æ–ª–∏—Ç–∏?"*.
    -   –Æ–∑–µ—Ä –ø—Ä–æ—Å—Ç–æ —Ç–∏—Å–Ω–µ **"–î–æ–∑–≤–æ–ª–∏—Ç–∏"**. –í—ñ–Ω –Ω–µ –º–∞—î –Ω—ñ—á–æ–≥–æ —Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏.
5.  **–¢–≤—ñ–π –°–µ—Ä–≤–µ—Ä**: –û—Ç—Ä–∏–º—É—î `code`, –¥–æ–¥–∞—î –°–í–Ü–ô `client_secret` (—è–∫–∏–π —Ç–∏ –æ—Ç—Ä–∏–º–∞–≤ –Ω–∞ –∫—Ä–æ—Ü—ñ 1) —ñ –æ–±–º—ñ–Ω—é—î –π–æ–≥–æ –Ω–∞ **Access Token**.

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¢–≤—ñ–π —Å–µ—Ä–≤–µ—Ä —Ç–µ–ø–µ—Ä –º–∞—î —Ç–æ–∫–µ–Ω, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –π–æ–º—É "—Ö–æ–¥–∏—Ç–∏" –≤ GitHub –≤—ñ–¥ —ñ–º–µ–Ω—ñ —Ü—å–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —é–∑–µ—Ä–∞. –ê–ª–µ `client_secret` –≤—Å–µ –æ–¥–Ω–æ —Ç—ñ–ª—å–∫–∏ —Ç–≤—ñ–π –æ–¥–∏–Ω.

---

## 3. –ù–∞—â–æ –Ω–∞–º Refresh Token?
–¢–æ–∫–µ–Ω–∏ (Access Tokens) –∑–∞–∑–≤–∏—á–∞–π –∂–∏–≤—É—Ç—å –Ω–µ–¥–æ–≤–≥–æ (30-60 —Ö–≤) –¥–ª—è –±–µ–∑–ø–µ–∫–∏. –©–æ–± –ê–≥–µ–Ω—Ç –Ω–µ –ø–∏—Ç–∞–≤ —Ç–µ–±–µ –ø–∞—Ä–æ–ª—å –∫–æ–∂–Ω—É –≥–æ–¥–∏–Ω—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **Refresh Token**. –¶–µ "–¥–æ–≤–≥–æ–≤—ñ—á–Ω–∏–π" –∫–ª—é—á, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –ê–≥–µ–Ω—Ç—É –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–æ–≤–∏–π Access Token –±–µ–∑ —Ç–≤–æ—î—ó —É—á–∞—Å—Ç—ñ.

---
### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –≤ –Ω–∞—à–æ–º—É –ø—Ä–æ—î–∫—Ç—ñ:
–ú–∏ —ñ–Ω—Ç–µ–≥—Ä—É—î–º–æ OAuth —Ç–∞–∫, —â–æ–± —Ç–≤—ñ–π –ê–≥–µ–Ω—Ç –º—ñ–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Å–≤–æ—ó –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ MCP —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤, –Ω–µ —Ç—É—Ä–±—É—é—á–∏ —Ç–µ–±–µ, –ø–æ–∫–∏ —É –Ω—å–æ–≥–æ —î –¥—ñ–π—Å–Ω–∏–π Refresh Token.

### 2.8. –î–µ –ª–µ–∂–∏—Ç—å —Ç–æ–∫–µ–Ω —ñ —è–∫ –ê–≥–µ–Ω—Ç –Ω–∏–º ¬´–∫–æ—Ä–∏—Å—Ç—É—î—Ç—å—Å—è¬ª?

–¢–∏ —Å—Ç–∞–≤–∏—à –ø–∏—Ç–∞–Ω–Ω—è –Ω–∞ –º—ñ–ª—å–π–æ–Ω –¥–æ–ª–∞—Ä—ñ–≤! üí∞ –î–∞–≤–∞–π —Ä–æ–∑–±–µ—Ä–µ–º–æ—Å—è, —á–æ–º—É –ê–≥–µ–Ω—Ç—É –∫—Ä–∞—â–µ **–Ω–µ –±–∞—á–∏—Ç–∏** —Ç–≤—ñ–π —Ç–æ–∫–µ–Ω –≤—ñ–¥ GitHub.

#### 1. –î–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Ç–æ–∫–µ–Ω (Access Token GitHub)?
–í—ñ–Ω –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –Ω–∞ **–¢–≤–æ—î–º—É –°–µ—Ä–≤–µ—Ä—ñ (Backend)**. 
- –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É –±–∞–∑—ñ Neo4j.
- –í—ñ–Ω –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π –¥–æ —Ç–≤–æ–≥–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ ID: `User(Cyril) -> GitHub_Token(ghp_123...)`.
- –Æ–∑–µ—Ä (—Ç–∏) –Ω—ñ–∫—É–¥–∏ —Ü–µ–π —Ç–æ–∫–µ–Ω –Ω–µ –Ω–æ—Å–∏—Ç—å. –í—ñ–Ω –ª–µ–∂–∏—Ç—å —É —Å–µ–π—Ñ—ñ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.

#### 2. –©–æ —Ç–æ–¥—ñ –∑–±–µ—Ä—ñ–≥–∞—î –ê–≥–µ–Ω—Ç?
–ê–≥–µ–Ω—Ç –∑–±–µ—Ä—ñ–≥–∞—î —Ç—ñ–ª—å–∫–∏ **–ù–ê–® –í–ù–£–¢–†–Ü–®–ù–Ü–ô JWT** (—Ç–≤–æ—é –ø–µ—Ä–µ–ø—É—Å—Ç–∫—É –¥–æ –Ω–∞—à–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤). 
–í –Ω—å–æ–º—É –º–æ–∂–µ –±—É—Ç–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ: `{"sub": "cyril", "role": "admin"}`.

#### 3. –Ø–∫ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤–∏–∫–ª–∏–∫ —Ç—É–ª–∑–∏? (–ü—Ä–æ—Ü–µ—Å)

1.  **–ê–≥–µ–Ω—Ç**: –ö–∞–∂–µ: *"–Ø —Ö–æ—á—É —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π"*. –í—ñ–Ω –≤–∏–∫–ª–∏–∫–∞—î —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `github_create_repo` —ñ –ø–µ—Ä–µ–¥–∞—î –π–æ–º—É **–ù–ê–® JWT**.
2.  **–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (–¢—É–ª–∑–∞)**: –¶–µ –∫–æ–¥ –Ω–∞ —Ç–≤–æ—î–º—É —Å–µ—Ä–≤–µ—Ä—ñ. –í—ñ–Ω:
    - –ü—Ä–∏–π–º–∞—î –Ω–∞—à JWT.
    - –î–µ–∫–æ–¥—É—î –π–æ–≥–æ —ñ –±–∞—á–∏—Ç—å: *"–û, —Ü–µ –ö–∏—Ä–∏–ª–æ (ID: cyril)"*.
    - –°–µ—Ä–≤–µ—Ä –π–¥–µ –≤ —Å–≤–æ—é –±–∞–∑—É —ñ –∫–∞–∂–µ: *"–î–∞–π –º–µ–Ω—ñ —Ç–æ–∫–µ–Ω GitHub –¥–ª—è –ö–∏—Ä–∏–ª–∞"*.
    - –û—Ç—Ä–∏–º—É—î —Ç–æ–∫–µ–Ω —ñ **—Å–∞–º** —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç –¥–æ GitHub API.
3.  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¢—É–ª–∑–∞ –ø–æ–≤–µ—Ä—Ç–∞—î –ê–≥–µ–Ω—Ç—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å: *"–†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —Å—Ç–≤–æ—Ä–µ–Ω–æ"*.

#### –ß–æ–º—É —Ü–µ –±–µ–∑–ø–µ—á–Ω–æ?
- **–ê–≥–µ–Ω—Ç –Ω–µ –±–∞—á–∏—Ç—å —Ç–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è –≤—ñ–¥ GitHub**. –Ø–∫—â–æ –ê–≥–µ–Ω—Ç–∞ "–ø–µ—Ä–µ–∫–æ–Ω–∞—é—Ç—å" —á–µ—Ä–µ–∑ –ø—Ä–æ–º–ø—Ç –≤—ñ–¥–¥–∞—Ç–∏ –≤—Å—ñ —Å–≤–æ—ó –¥–∞–Ω—ñ, –≤—ñ–Ω –≤—ñ–¥–¥–∞—Å—Ç—å –Ω–∞—à JWT, –∞–ª–µ –Ω–µ —Ç–≤—ñ–π –∫–ª—é—á –≤—ñ–¥ GitHub.
- **–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –≤–∏—Ç–æ–∫—É**: –¢–≤—ñ–π GitHub-–∫–ª—é—á –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø–æ–∫–∏–¥–∞—î –º–µ–∂—ñ —Ç–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

---

### 2.9. "–ë—ñ–ª—ñ –ø–ª—è–º–∏": –Ø–∫ –¥–∞–Ω—ñ —Ç–∞ —Ç–æ–∫–µ–Ω–∏ –∑–≤'—è–∑—É—é—Ç—å—Å—è –¥–æ–∫—É–ø–∏

–¢–∏ –ø—Ä–∞–≤–∏–π, –≤ –æ–ø–∏—Å—ñ –±—É–ª–∏ –ø—Ä–æ–≥–∞–ª–∏–Ω–∏. –î–∞–≤–∞–π –∑–∞–ø–æ–≤–Ω–∏–º–æ —ó—Ö —Ç–µ—Ö–Ω—ñ—á–Ω–æ:

#### 1. –ó–≤—ñ–¥–∫–∏ –±–µ—Ä–µ—Ç—å—Å—è Email? (ID Token)
–ö–æ–ª–∏ —Ç–≤—ñ–π —Å–µ—Ä–≤–µ—Ä –æ—Ç—Ä–∏–º—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤—ñ–¥ Google, –≤—ñ–Ω –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –Ω–µ –∑ –æ–¥–Ω–∏–º —Ç–æ–∫–µ–Ω–æ–º, –∞ –∑ —Ü—ñ–ª–∏–º –ø–∞–∫–µ—Ç–æ–º:
- **`id_token`**: –¶–µ JWT. –¢–≤—ñ–π —Å–µ—Ä–≤–µ—Ä –π–æ–≥–æ —Ä–æ–∑–ø–∞–∫–æ–≤—É—î. –í—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω—å–æ–≥–æ **–≤–∂–µ —î** –ø–æ–ª–µ `"email": "cyril@gmail.com"`. –ó–∞–≤–¥—è–∫–∏ —Ü—å–æ–º—É –º–∏ –∑–Ω–∞—î–º–æ, —Ö—Ç–æ –ø—Ä–∏–π—à–æ–≤.
- **`access_token`**: –¶–µ –ø—Ä–æ—Å—Ç–æ —Ä—è–¥–æ–∫ (–Ω–µ JWT). –í—ñ–Ω –¥–æ–∑–≤–æ–ª—è—î —Ö–æ–¥–∏—Ç–∏ –≤ GitHub/Google.

#### 2. –î–µ –º–∏ —Ü–µ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ? (–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö)
–£ —Ç–≤–æ—ó–π —Å–∏—Å—Ç–µ–º—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É Neo4j) —Ç–∏ —Å—Ç–≤–æ—Ä—é—î—à –≤—É–∑–æ–ª `User`. 
```cypher
MERGE (u:User {email: "cyril@gmail.com"})
SET u.github_access_token = "ghp_ABC123..."
```
–¢–∞–∫ –º–∏ –Ω–∞–∑–∞–≤–∂–¥–∏ (–∞–±–æ –ø–æ–∫–∏ –Ω–µ –ø—Ä–æ—Å—Ç—Ä–æ—á–∏—Ç—å—Å—è) –∑–≤'—è–∑—É—î–º–æ —Ç–≤—ñ–π —ñ–º–µ–π–ª –∑ —Ç–≤–æ—ó–º –∫–ª—é—á–µ–º –¥–æ GitHub —É –Ω–∞—à–æ–º—É –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–º—É —Å–µ–π—Ñ—ñ (–±–∞–∑—ñ –¥–∞–Ω–∏—Ö).

#### 3. –ù–∞—à JWT (–ü–µ—Ä–µ–ø—É—Å—Ç–∫–∞ –¥–ª—è –ê–≥–µ–Ω—Ç–∞)
–¢–µ–ø–µ—Ä —Å–µ—Ä–≤–µ—Ä –≤–∏–¥–∞—î –ê–≥–µ–Ω—Ç—É **–ù–∞—à JWT**. –í –Ω—å–æ–º—É –Ω–∞–ø–∏—Å–∞–Ω–æ —Ç—ñ–ª—å–∫–∏: `{"sub": "cyril@gmail.com"}`. 

#### 4. –ú–µ—Ö–∞–Ω—ñ–∫–∞ "–í—Ä–∞–ø–µ—Ä–∞" (–¢—É–ª–∑–∞-–ü—Ä–æ–∫—Å—ñ)
–¶–µ —Å–∞–º–µ —Ç–µ, —â–æ —Ç–∏ –Ω–∞–∑–≤–∞–≤ "–≤—Ä–∞–ø–µ—Ä–æ–º". –£ ADK (–∞–±–æ MCP) —Ü–µ –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:

1.  **–ê–≥–µ–Ω—Ç** –≤–∏–∫–ª–∏–∫–∞—î —Ç—É–ª–∑—É `github_search(query="python")`.
2.  **–ù–∞—à JWT** –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–¥–∞—î—Ç—å—Å—è –¥–æ —Ü—å–æ–≥–æ –≤–∏–∫–ª–∏–∫—É (—Ü–µ —Ä–æ–±–∏—Ç—å –Ω–∞—à Security Layer).
3.  **–í—Ä–∞–ø–µ—Ä (Security Middleware)** –ø–µ—Ä–µ—Ö–æ–ø–ª—é—î –∑–∞–ø–∏—Ç —ñ —Ä–æ–±–∏—Ç—å —Ç—Ä–∏ —Ä–µ—á—ñ:
    - **–ê)** –î–µ–∫–æ–¥—É—î –Ω–∞—à JWT -> –æ—Ç—Ä–∏–º—É—î `cyril@gmail.com`.
    - **–ë)** –ô–¥–µ –≤ Neo4j -> —à—É–∫–∞—î —é–∑–µ—Ä–∞ `cyril@gmail.com` -> –∑–∞–±–∏—Ä–∞—î –π–æ–≥–æ `github_access_token`.
    - **–í)** –ü—ñ–¥—Å—Ç–∞–≤–ª—è—î —Ü–µ–π —Ç–æ–∫–µ–Ω —É Header —Å–ø—Ä–∞–≤–∂–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É –¥–æ GitHub.

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ê–≥–µ–Ω—Ç –æ—Ç—Ä–∏–º–∞–≤ –¥–∞–Ω—ñ, –∞–ª–µ –≤—ñ–Ω –Ω—ñ–∫–æ–ª–∏ –Ω–µ –±–∞—á–∏–≤ —Ç–≤—ñ–π —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –∫–ª—é—á –≤—ñ–¥ GitHub. –í—ñ–Ω –±–∞—á–∏–≤ –ª–∏—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–æ–±–æ—Ç–∏ "–≤—Ä–∞–ø–µ—Ä–∞".

---

**–¢–≤–æ—î –∑–∞–≤–¥–∞–Ω–Ω—è –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É**: –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –æ–±–º—ñ–Ω –∫–æ–¥—É –Ω–∞ —Ç–æ–∫–µ–Ω. –ê–ª–µ —Å–ø–æ—á–∞—Ç–∫—É ‚Äî –∑–∞–∫—Ä–∏–≤–∞—î–º–æ –ú–æ–¥—É–ª—å 1!
